<style>
/* ---------- SEARCH BAR ---------- */
.search-bar {
  background: #fff;
  border-radius: 50px;
  padding: 6px 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  gap: 10px;
}

.search-input {
  border: none;
  outline: none;
  width: 220px;
  padding: 8px;
}

.search-button {
  background: #ff385c;
  color: white;
  border: none;
  border-radius: 30px;
  padding: 8px 18px;
  font-weight: 600;
}

.search-button i {
  margin-right: 6px;
}

/* ---------- NAVBAR ---------- */
.nav-link {
  font-weight: 500;
}

/* ---------- MOBILE SIDEBAR ---------- */
@media (max-width: 768px) {

  .navbar-collapse {
    position: fixed;
    top: 0;
    right: -100%;
    width: 200px;
    height: 100vh;
    background-color: #fff;
    box-shadow: -2px 0 6px rgba(0,0,0,0.2);
    transition: right 0.3s ease;
    z-index: 1050;
    padding: 1rem;
  }

  .navbar-collapse.show {
    right: 0;
  }

  .navbar-nav {
    flex-direction: column;
    width: 100%;
  }

  .navbar-nav .nav-link {
    padding: 0.75rem 0;
    border-bottom: 1px solid #eee;
  }

  .search-bar {
    width: 100%;
    flex-direction: column;
    margin-top: 1rem;
  }

  .search-input,
  .search-button {
    width: 100%;
  }

  .mobile-backdrop {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.3);
    z-index: 1049;
  }

  .mobile-backdrop.show {
    display: block;
  }
}
</style>

<nav class="navbar navbar-expand-md bg-body-light">
  <div class="container-fluid">
    <a class="navbar-brand" href="/listings">
      <i class="fa-regular fa-compass"></i>
    </a>

    <button class="navbar-toggler" type="button">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse">
      <div class="navbar-nav">
        <a class="nav-link" href="/listings">Explore</a>
      </div>

      <div class="navbar-nav ms-auto">
        <form class="search-bar d-flex align-items-center" action="/listings" method="GET">
          <input
            type="search"
            name="q"
            class="search-input"
            placeholder="Search destination"
          />
          <button type="submit" class="search-button">
            <i class="fa-solid fa-magnifying-glass"></i>
            Search
          </button>
        </form>
      </div>

      <div class="navbar-nav ms-auto">
        <a class="nav-link" href="/listings/new">Airbnb your home</a>

        <% if (!currUser) { %>
          <a class="nav-link" href="/signup"><b>Sign up</b></a>
          <a class="nav-link" href="/login"><b>Log in</b></a>
        <% } %>

        <% if (currUser) { %>
          <a class="nav-link" href="/logout"><b>Log out</b></a>
        <% } %>
      </div>
    </div>
  </div>
</nav>

<div class="mobile-backdrop" id="mobileBackdrop"></div>

<script>
  const toggler = document.querySelector(".navbar-toggler");
  const collapse = document.querySelector(".navbar-collapse");
  const backdrop = document.getElementById("mobileBackdrop");

  toggler.addEventListener("click", () => {
    collapse.classList.add("show");
    backdrop.classList.add("show");
  });

  backdrop.addEventListener("click", () => {
    collapse.classList.remove("show");
    backdrop.classList.remove("show");
  });
</script>
